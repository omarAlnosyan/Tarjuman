# ğŸ—ï¸ Architecture Diagram - ØªØ±Ø¬Ù…Ø§Ù† (Tarjuman)
## Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ù…Ø¹Ù…Ø§Ø±ÙŠ Ø§Ù„ÙƒØ§Ù…Ù„ Ù„Ù„Ù…Ø´Ø±ÙˆØ¹

**Version:** 2.0  
**Date:** 2026-01-23  
**Status:** âœ… Production Ready

---

## ğŸ“Š System Overview - Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø¸Ø§Ù…

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                    ØªØ±Ø¬Ù…Ø§Ù† (Tarjuman)                                  â”‚
â”‚                         Ù†Ø¸Ø§Ù… Ø°ÙƒÙŠ Ù„Ø´Ø±Ø­ Ø§Ù„Ø´Ø¹Ø± Ø§Ù„Ø¹Ø±Ø¨ÙŠ Ø§Ù„ÙØµÙŠØ­                            â”‚
â”‚                              RAG-based Poetry Assistant                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ Complete Architecture - Ø§Ù„Ù…Ø¹Ù…Ø§Ø±ÙŠØ© Ø§Ù„ÙƒØ§Ù…Ù„Ø©

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                    Layer 1: User Interface                           â”‚
â”‚                                    Ø·Ø¨Ù‚Ø© ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    Frontend Application (Next.js)                           â”‚   â”‚
â”‚  â”‚                    Port: 3000                                                â”‚   â”‚
â”‚  â”‚                    Location: tarjuman-ui/                                    â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚                                                                               â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚   Homepage Component  â”‚  â”‚   Search Component   â”‚  â”‚  Result Display â”‚ â”‚   â”‚
â”‚  â”‚  â”‚   (page.tsx)          â”‚  â”‚   (Input + Button)    â”‚  â”‚  (Verse Card)    â”‚ â”‚   â”‚
â”‚  â”‚  â”‚                       â”‚  â”‚                       â”‚  â”‚                 â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ Welcome Message     â”‚  â”‚ â€¢ Search Input        â”‚  â”‚ â€¢ Verse Text     â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ Example Chips       â”‚  â”‚ â€¢ Submit Button       â”‚  â”‚ â€¢ Poet Name      â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ Heritage Design     â”‚  â”‚ â€¢ Loading State       â”‚  â”‚ â€¢ Verse Number   â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â€¢ Explanation    â”‚ â”‚   â”‚
â”‚  â”‚                                                          â”‚ â€¢ Source Info    â”‚ â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                 â”‚ â”‚   â”‚
â”‚  â”‚  â”‚   Sidebar Component   â”‚  â”‚   API Integration    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚  â”‚   (Examples List)     â”‚  â”‚   (fetch/axios)      â”‚                       â”‚   â”‚
â”‚  â”‚  â”‚                       â”‚  â”‚                       â”‚                       â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ Example Verses     â”‚  â”‚ â€¢ POST /search        â”‚                       â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ Click to Search    â”‚  â”‚ â€¢ GET /poets          â”‚                       â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ Heritage Theme     â”‚  â”‚ â€¢ GET /examples        â”‚                       â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚   â”‚
â”‚  â”‚                                                                               â”‚   â”‚
â”‚  â”‚  Technologies:                                                                â”‚   â”‚
â”‚  â”‚  â€¢ Next.js 14+ (React Framework)                                            â”‚   â”‚
â”‚  â”‚  â€¢ TypeScript                                                                â”‚   â”‚
â”‚  â”‚  â€¢ TailwindCSS (Styling)                                                     â”‚   â”‚
â”‚  â”‚  â€¢ Lucide React (Icons)                                                     â”‚   â”‚
â”‚  â”‚  â€¢ Amiri Font (Arabic Typography)                                           â”‚   â”‚
â”‚  â”‚                                                                               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â†“ HTTP/JSON (REST API)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                    Layer 2: API Gateway                              â”‚
â”‚                                    Ø·Ø¨Ù‚Ø© Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ù€ API                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    FastAPI Backend Server                                  â”‚   â”‚
â”‚  â”‚                    Port: 8000                                               â”‚   â”‚
â”‚  â”‚                    Location: api/main.py                                    â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚                                                                               â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚                      API Endpoints                                â”‚   â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚   â”‚
â”‚  â”‚  â”‚                                                                   â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  POST /search                                                    â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”œâ”€ Input: { "query": "Ø¨ÙŠØª Ø´Ø¹Ø±ÙŠ" }                              â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”œâ”€ Output: SearchResponse                                      â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€ Function: search_verses()                                   â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                                   â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  GET /health                                                     â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”œâ”€ Output: HealthResponse                                      â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€ Function: health_check()                                     â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                                   â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  GET /poets                                                      â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”œâ”€ Output: List[PoetInfo]                                       â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€ Function: get_poets()                                       â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                                   â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  GET /examples                                                   â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”œâ”€ Output: List[ExampleItem]                                    â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€ Function: get_examples()                                     â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                                   â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                                                               â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚                    Middleware Layer                              â”‚   â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚   â”‚
â”‚  â”‚  â”‚                                                                   â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ CORS Middleware (Cross-Origin Resource Sharing)              â”‚   â”‚   â”‚
â”‚  â”‚  â”‚    â””â”€ Allow: All origins (*)                                    â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                                   â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Request Validation (Pydantic Models)                         â”‚   â”‚   â”‚
â”‚  â”‚  â”‚    â””â”€ SearchRequest, SearchResponse, etc.                      â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                                   â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Error Handling                                               â”‚   â”‚   â”‚
â”‚  â”‚  â”‚    â””â”€ HTTPException with Arabic messages                        â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                                   â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                                                               â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚                    Global State (AppState)                        â”‚   â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚   â”‚
â”‚  â”‚  â”‚                                                                   â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ retriever: HybridRetriever (Singleton)                       â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ llm: ChatGroq (Llama 3.3 70B)                                 â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ chunks: List[Dict] (687 verses)                              â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ poets: List[PoetInfo] (7 poets)                               â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                                   â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  Loaded at startup via @app.on_event("startup")                  â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                                   â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                                                               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â†“ Function Calls
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                    Layer 3: Business Logic                          â”‚
â”‚                                    Ø·Ø¨Ù‚Ø© Ù…Ù†Ø·Ù‚ Ø§Ù„Ø¹Ù…Ù„                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    Guardrails & Validation                                   â”‚   â”‚
â”‚  â”‚                    Location: api/main.py::is_poetry_query()                  â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚                                                                               â”‚   â”‚
â”‚  â”‚  âœ… Check 1: Minimum Length (>= 5 characters)                              â”‚   â”‚
â”‚  â”‚  âœ… Check 2: Reject General Questions                                       â”‚   â”‚
â”‚  â”‚     â€¢ "ÙƒÙŠÙ Ø­Ø§Ù„Ùƒ", "Ù…Ù† Ø£Ù†Øª", "Ù…Ø±Ø­Ø¨Ø§", etc.                                   â”‚   â”‚
â”‚  â”‚  âœ… Check 3: Must contain Arabic text                                       â”‚   â”‚
â”‚  â”‚  âœ… Check 4: Reject non-poetry patterns                                     â”‚   â”‚
â”‚  â”‚                                                                               â”‚   â”‚
â”‚  â”‚  Result:                                                                      â”‚   â”‚
â”‚  â”‚  â€¢ âœ… Valid â†’ Proceed to Search                                              â”‚   â”‚
â”‚  â”‚  â€¢ âŒ Invalid â†’ Return 400 Error                                            â”‚   â”‚
â”‚  â”‚                                                                               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                        â†“                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    Hybrid Search Engine                                     â”‚   â”‚
â”‚  â”‚                    Location: src/retrieval/hybrid_search.py                â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚                                                                               â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚  Step 1: Exact Match (Fast Path)                                   â”‚   â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚   â”‚
â”‚  â”‚  â”‚  Function: SparseRetriever.exact_match()                           â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  Location: src/retrieval/sparse_search.py                          â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                                     â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  Process:                                                           â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  1. Normalize query (remove diacritics, "..." )                   â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  2. Search in documents (substring match)                          â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  3. Return first match (score = 1.0)                               â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                                     â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  âœ… If found â†’ Return immediately                                 â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  âŒ If not found â†’ Continue to Step 2                              â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                                     â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                                                               â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚  Step 2: BM25 Search (Keyword-based)                               â”‚   â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚   â”‚
â”‚  â”‚  â”‚  Function: SparseRetriever.search()                                 â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  Location: src/retrieval/sparse_search.py                          â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                                     â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  Process:                                                           â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  1. Tokenize query (Arabic tokenization)                           â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  2. Build BM25Okapi index (if not exists)                          â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  3. Calculate BM25 scores for all documents                       â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  4. Return Top-K results (k=5)                                     â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                                     â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  Algorithm: BM25 (Best Matching 25)                                â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  Weight: 70% (sparse_weight)                                       â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                                     â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                                                               â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚  Step 3: FAISS Search (Semantic)                                   â”‚   â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚   â”‚
â”‚  â”‚  â”‚  Function: DenseRetriever.search()                                 â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  Location: src/retrieval/dense_search.py                           â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                                     â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  Process:                                                           â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  1. Load ChromaDB vector store                                     â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  2. Embed query (multilingual-e5-base)                             â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  3. Similarity search (cosine similarity)                          â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  4. Return Top-K results (k=5)                                     â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                                     â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  Embedding Model: intfloat/multilingual-e5-base                    â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  Vector DB: ChromaDB                                                â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  Weight: 30% (dense_weight)                                        â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                                     â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                                                               â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚  Step 4: Merge & Rank Results                                       â”‚   â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚   â”‚
â”‚  â”‚  â”‚  Function: HybridRetriever._merge_results()                        â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                                     â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  Algorithm:                                                         â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  1. Reciprocal Rank Fusion (RRF)                                   â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  2. Weighted Combination:                                           â”‚   â”‚   â”‚
â”‚  â”‚  â”‚     hybrid_score = 0.7 * bm25_score + 0.3 * faiss_score            â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  3. Sort by hybrid_score (descending)                              â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  4. Return Top-1 result (k=1)                                       â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                                     â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  Output: SearchResult object                                        â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ verse_text, poet_name, verse_number, explanation, score         â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                                     â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                                                               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                        â†“                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    LLM Enhancement Layer                                      â”‚   â”‚
â”‚  â”‚                    Location: api/main.py::enhance_explanation()               â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚                                                                               â”‚   â”‚
â”‚  â”‚  Model: Llama 3.3 70B Versatile                                             â”‚   â”‚
â”‚  â”‚  Provider: Groq API                                                          â”‚   â”‚
â”‚  â”‚  Temperature: 0.1 (high accuracy)                                            â”‚   â”‚
â”‚  â”‚  Max Tokens: 512                                                             â”‚   â”‚
â”‚  â”‚                                                                               â”‚   â”‚
â”‚  â”‚  Process:                                                                     â”‚   â”‚
â”‚  â”‚  1. Extract explanation from database                                         â”‚   â”‚
â”‚  â”‚  2. Build prompt:                                                            â”‚   â”‚
â”‚  â”‚     "Ø£Ø¹Ø¯ ØµÙŠØ§ØºØ© Ø§Ù„Ø´Ø±Ø­ Ø§Ù„ØªØ§Ù„ÙŠ Ø¨Ù„ØºØ© Ø¹Ø±Ø¨ÙŠØ© ÙØµÙŠØ­Ø© ÙˆÙˆØ§Ø¶Ø­Ø©..."                      â”‚   â”‚
â”‚  â”‚  3. Call LLM via Groq API                                                    â”‚   â”‚
â”‚  â”‚  4. Return enhanced explanation                                              â”‚   â”‚
â”‚  â”‚                                                                               â”‚   â”‚
â”‚  â”‚  Fallback:                                                                    â”‚   â”‚
â”‚  â”‚  â€¢ If LLM unavailable â†’ Return original DB explanation                      â”‚   â”‚
â”‚  â”‚  â€¢ If LLM fails â†’ Return original DB explanation                             â”‚   â”‚
â”‚  â”‚                                                                               â”‚   â”‚
â”‚  â”‚  Rate Limits (Free Tier):                                                     â”‚   â”‚
â”‚  â”‚  â€¢ 30 requests/minute                                                        â”‚   â”‚
â”‚  â”‚  â€¢ 14,400 requests/day                                                        â”‚   â”‚
â”‚  â”‚                                                                               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â†“ File I/O
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                    Layer 4: Data Layer                              â”‚
â”‚                                    Ø·Ø¨Ù‚Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    Structured Data (JSON)                                   â”‚   â”‚
â”‚  â”‚                    Location: data/processed/all_chunks_final.json           â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚                                                                               â”‚   â”‚
â”‚  â”‚  Format: JSON Array                                                          â”‚   â”‚
â”‚  â”‚  Size: 687 verses                                                            â”‚   â”‚
â”‚  â”‚  Encoding: UTF-8                                                             â”‚   â”‚
â”‚  â”‚                                                                               â”‚   â”‚
â”‚  â”‚  Schema:                                                                      â”‚   â”‚
â”‚  â”‚  {                                                                            â”‚   â”‚
â”‚  â”‚    "chunk_id": 1,                                                             â”‚   â”‚
â”‚  â”‚    "chunk_type": "verse_with_explanation",                                   â”‚   â”‚
â”‚  â”‚    "verse_text": "Ù‚ÙÙØ§ Ù†Ø¨Ùƒ Ù…Ù† Ø°ÙÙƒØ±Ù‰ Ø­Ø¨ÙŠØ¨Ù ÙˆÙ…Ù†Ø²Ù„...",                        â”‚   â”‚
â”‚  â”‚    "verse_number": 3,                                                         â”‚   â”‚
â”‚  â”‚    "poet_name": "Ø§Ù…Ø±Ø¤ Ø§Ù„Ù‚ÙŠØ³",                                               â”‚   â”‚
â”‚  â”‚    "poem_name": "Ù…Ø¹Ù„Ù‚Ø© Ø§Ù…Ø±Ø¦ Ø§Ù„Ù‚ÙŠØ³",                                         â”‚   â”‚
â”‚  â”‚    "text": "Ø§Ù„Ø¨ÙŠØª: ...\n\nØ§Ù„Ø´Ø±Ø­: ...",                                      â”‚   â”‚
â”‚  â”‚    "source": {                                                                â”‚   â”‚
â”‚  â”‚      "file": "Ø´Ø±Ø­-Ø§Ù„Ù…Ø¹Ù„Ù‚Ø§Øª-Ø§Ù„Ø³Ø¨Ø¹-Ù„Ù„Ø²ÙˆØ²Ù†ÙŠ.docx",                              â”‚   â”‚
â”‚  â”‚      "book": "Ø´Ø±Ø­ Ø§Ù„Ù…Ø¹Ù„Ù‚Ø§Øª Ø§Ù„Ø³Ø¨Ø¹ Ù„Ù„Ø²ÙˆØ²Ù†ÙŠ"                                    â”‚   â”‚
â”‚  â”‚    },                                                                         â”‚   â”‚
â”‚  â”‚    "metadata": {                                                             â”‚   â”‚
â”‚  â”‚      "char_count": 1614,                                                     â”‚   â”‚
â”‚  â”‚      "has_explanation": true                                                 â”‚   â”‚
â”‚  â”‚    }                                                                         â”‚   â”‚
â”‚  â”‚  }                                                                            â”‚   â”‚
â”‚  â”‚                                                                               â”‚   â”‚
â”‚  â”‚  Poets (7):                                                                   â”‚   â”‚
â”‚  â”‚  â€¢ Ø§Ù…Ø±Ø¤ Ø§Ù„Ù‚ÙŠØ³ (103 verses)                                                  â”‚   â”‚
â”‚  â”‚  â€¢ Ø·Ø±ÙØ© Ø¨Ù† Ø§Ù„Ø¹Ø¨Ø¯ (118 verses)                                               â”‚   â”‚
â”‚  â”‚  â€¢ Ø²Ù‡ÙŠØ± Ø¨Ù† Ø£Ø¨ÙŠ Ø³Ù„Ù…Ù‰ (74 verses)                                             â”‚   â”‚
â”‚  â”‚  â€¢ Ù„Ø¨ÙŠØ¯ Ø¨Ù† Ø±Ø¨ÙŠØ¹Ø© (106 verses)                                               â”‚   â”‚
â”‚  â”‚  â€¢ Ø¹Ù…Ø±Ùˆ Ø¨Ù† ÙƒÙ„Ø«ÙˆÙ… (115 verses)                                               â”‚   â”‚
â”‚  â”‚  â€¢ Ø¹Ù†ØªØ±Ø© Ø¨Ù† Ø´Ø¯Ø§Ø¯ (85 verses)                                                 â”‚   â”‚
â”‚  â”‚  â€¢ Ø§Ù„Ø­Ø§Ø±Ø« Ø¨Ù† Ø­Ù„Ø²Ø© (86 verses)                                                â”‚   â”‚
â”‚  â”‚                                                                               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    Vector Database (ChromaDB)                                 â”‚   â”‚
â”‚  â”‚                    Location: data/vectordb/                                  â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚                                                                               â”‚   â”‚
â”‚  â”‚  Files:                                                                       â”‚   â”‚
â”‚  â”‚  â€¢ chroma.sqlite3 (SQLite database)                                          â”‚   â”‚
â”‚  â”‚  â€¢ [collection files] (embeddings + metadata)                               â”‚   â”‚
â”‚  â”‚                                                                               â”‚   â”‚
â”‚  â”‚  Embedding Model:                                                            â”‚   â”‚
â”‚  â”‚  â€¢ intfloat/multilingual-e5-base                                             â”‚   â”‚
â”‚  â”‚  â€¢ Dimension: 768                                                            â”‚   â”‚
â”‚  â”‚  â€¢ Language: Multilingual (supports Arabic)                                  â”‚   â”‚
â”‚  â”‚                                                                               â”‚   â”‚
â”‚  â”‚  Index Type:                                                                 â”‚   â”‚
â”‚  â”‚  â€¢ FAISS (Facebook AI Similarity Search)                                    â”‚   â”‚
â”‚  â”‚  â€¢ Similarity: Cosine                                                        â”‚   â”‚
â”‚  â”‚                                                                               â”‚   â”‚
â”‚  â”‚  Usage:                                                                       â”‚   â”‚
â”‚  â”‚  â€¢ Semantic search (Step 3 in Hybrid Search)                                 â”‚   â”‚
â”‚  â”‚  â€¢ Loaded at startup                                                         â”‚   â”‚
â”‚  â”‚                                                                               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    Raw Data Source                                           â”‚   â”‚
â”‚  â”‚                    Location: data/raw/Ø´Ø±Ø­-Ø§Ù„Ù…Ø¹Ù„Ù‚Ø§Øª-Ø§Ù„Ø³Ø¨Ø¹-Ù„Ù„Ø²ÙˆØ²Ù†ÙŠ.docx       â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚                                                                               â”‚   â”‚
â”‚  â”‚  Format: DOCX (Microsoft Word)                                               â”‚   â”‚
â”‚  â”‚  Processing: process_docx_v2.py                                             â”‚   â”‚
â”‚  â”‚                                                                               â”‚   â”‚
â”‚  â”‚  Steps:                                                                       â”‚   â”‚
â”‚  â”‚  1. Read DOCX file                                                            â”‚   â”‚
â”‚  â”‚  2. Parse poem headers                                                        â”‚   â”‚
â”‚  â”‚  3. Extract verse numbers                                                     â”‚   â”‚
â”‚  â”‚  4. Extract verse text                                                        â”‚   â”‚
â”‚  â”‚  5. Extract explanations                                                      â”‚   â”‚
â”‚  â”‚  6. Create structured chunks                                                  â”‚   â”‚
â”‚  â”‚  7. Save to all_chunks_final.json                                            â”‚   â”‚
â”‚  â”‚                                                                               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Complete Data Flow - ØªØ¯ÙÙ‚ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙƒØ§Ù…Ù„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              User Action Flow                                       â”‚
â”‚                              ØªØ¯ÙÙ‚ Ø¹Ù…Ù„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. User Input
   â””â”€ User types: "Ø¹ÙØª Ø§Ù„Ø¯ÙŠØ§Ø± Ù…Ø­Ù„Ù‡Ø§ ÙÙ…Ù‚Ø§Ù…Ù‡Ø§"
      â†“
2. Frontend (Next.js)
   â””â”€ POST http://localhost:8000/search
      Body: { "query": "Ø¹ÙØª Ø§Ù„Ø¯ÙŠØ§Ø± Ù…Ø­Ù„Ù‡Ø§ ÙÙ…Ù‚Ø§Ù…Ù‡Ø§" }
      â†“
3. FastAPI Backend
   â””â”€ Endpoint: POST /search
      â†“
4. Guardrails Check
   â””â”€ is_poetry_query("Ø¹ÙØª Ø§Ù„Ø¯ÙŠØ§Ø± Ù…Ø­Ù„Ù‡Ø§ ÙÙ…Ù‚Ø§Ù…Ù‡Ø§")
      âœ… Valid (contains Arabic, not general question, length > 5)
      â†“
5. Hybrid Search Engine
   â”œâ”€ Step 1: exact_match()
   â”‚  â””â”€ SparseRetriever.exact_match()
   â”‚     â€¢ Normalize: "Ø¹ÙØª Ø§Ù„Ø¯ÙŠØ§Ø± Ù…Ø­Ù„Ù‡Ø§ ÙÙ…Ù‚Ø§Ù…Ù‡Ø§"
   â”‚     â€¢ Search in documents
   â”‚     âŒ Not found
   â”‚
   â”œâ”€ Step 2: BM25 Search
   â”‚  â””â”€ SparseRetriever.search(k=5)
   â”‚     â€¢ Tokenize query
   â”‚     â€¢ Calculate BM25 scores
   â”‚     â€¢ Top result: Score 0.85
   â”‚
   â”œâ”€ Step 3: FAISS Search
   â”‚  â””â”€ DenseRetriever.search(k=5)
   â”‚     â€¢ Embed query (multilingual-e5-base)
   â”‚     â€¢ Similarity search in ChromaDB
   â”‚     â€¢ Top result: Score 0.78
   â”‚
   â””â”€ Step 4: Merge & Rank
      â””â”€ HybridRetriever._merge_results()
         â€¢ RRF + Weighted: 0.7 * 0.85 + 0.3 * 0.78 = 0.829
         â€¢ Return Top-1: SearchResult
      â†“
6. Extract Result
   â””â”€ SearchResult {
        verse_text: "Ø¹ÙÙÙØªÙ Ø§Ù„Ø¯Ù‘ÙÙŠÙØ§Ø± Ù…ÙØ­ÙÙ„ÙÙ‘Ù‡ÙØ§ ÙÙÙ…ÙÙ‚ÙØ§Ù…ÙÙ‡ÙØ§...",
        poet_name: "Ù„Ø¨ÙŠØ¯ Ø¨Ù† Ø±Ø¨ÙŠØ¹Ø©",
        verse_number: 3,
        explanation: "Ø§Ù„Ø´Ø±Ø­ Ù…Ù† Ø§Ù„Ø²ÙˆØ²Ù†ÙŠ...",
        score: 0.829
      }
      â†“
7. LLM Enhancement (if available)
   â””â”€ enhance_explanation(verse_text, db_explanation, poet_name)
      â”œâ”€ Build prompt
      â”œâ”€ Call Groq API (Llama 3.3 70B)
      â””â”€ Return enhanced explanation
      â†“
8. API Response
   â””â”€ SearchResponse {
        query: "Ø¹ÙØª Ø§Ù„Ø¯ÙŠØ§Ø± Ù…Ø­Ù„Ù‡Ø§ ÙÙ…Ù‚Ø§Ù…Ù‡Ø§",
        total_results: 1,
        results: [{
          poet_name: "Ù„Ø¨ÙŠØ¯ Ø¨Ù† Ø±Ø¨ÙŠØ¹Ø©",
          verse_number: 3,
          verse_text: "Ø¹ÙÙÙØªÙ Ø§Ù„Ø¯Ù‘ÙÙŠÙØ§Ø±...",
          explanation: "Ø§Ù„Ø´Ø±Ø­ Ø§Ù„Ù…Ø­Ø³Ù‘Ù†..."
        }]
      }
      â†“
9. Frontend Display
   â””â”€ Render Verse Card
      â€¢ Display verse text
      â€¢ Display poet name
      â€¢ Display verse number
      â€¢ Display enhanced explanation
      â€¢ Display source info
      â†“
10. User sees result
    â””â”€ âœ… Success!
```

---

## ğŸ“ File Structure - Ù‡ÙŠÙƒÙ„ Ø§Ù„Ù…Ù„ÙØ§Øª

```
Tarjuman/
â”‚
â”œâ”€â”€ ğŸ“± Frontend (Next.js)
â”‚   â””â”€â”€ tarjuman-ui/
â”‚       â”œâ”€â”€ src/
â”‚       â”‚   â””â”€â”€ app/
â”‚       â”‚       â”œâ”€â”€ page.tsx          â† Main page component
â”‚       â”‚       â”œâ”€â”€ globals.css       â† Global styles
â”‚       â”‚       â””â”€â”€ layout.tsx        â† App layout
â”‚       â”œâ”€â”€ package.json
â”‚       â””â”€â”€ next.config.ts
â”‚
â”œâ”€â”€ ğŸ”§ Backend (FastAPI)
â”‚   â””â”€â”€ api/
â”‚       â””â”€â”€ main.py                   â† Main API server
â”‚
â”œâ”€â”€ ğŸ” Retrieval Engine
â”‚   â””â”€â”€ src/retrieval/
â”‚       â”œâ”€â”€ hybrid_search.py          â† Hybrid Retriever (BM25 + FAISS)
â”‚       â”œâ”€â”€ sparse_search.py          â† BM25 Search
â”‚       â”œâ”€â”€ dense_search.py            â† FAISS/ChromaDB Search
â”‚       â””â”€â”€ embeddings.py             â† Embedding utilities
â”‚
â”œâ”€â”€ ğŸ“Š Data Processing
â”‚   â”œâ”€â”€ process_docx_v2.py           â† DOCX â†’ JSON processor
â”‚   â”œâ”€â”€ rebuild_index.py              â† Rebuild search indices
â”‚   â””â”€â”€ build_vectordb.py             â† Build vector database
â”‚
â”œâ”€â”€ ğŸ’¾ Data Storage
â”‚   â””â”€â”€ data/
â”‚       â”œâ”€â”€ raw/
â”‚       â”‚   â””â”€â”€ Ø´Ø±Ø­-Ø§Ù„Ù…Ø¹Ù„Ù‚Ø§Øª-Ø§Ù„Ø³Ø¨Ø¹-Ù„Ù„Ø²ÙˆØ²Ù†ÙŠ.docx  â† Source file
â”‚       â”œâ”€â”€ processed/
â”‚       â”‚   â””â”€â”€ all_chunks_final.json  â† 687 verses (JSON)
â”‚       â””â”€â”€ vectordb/                  â† ChromaDB files
â”‚
â”œâ”€â”€ âš™ï¸ Configuration
â”‚   â”œâ”€â”€ env_template.txt              â† API keys (GROQ_API_KEY)
â”‚   â”œâ”€â”€ requirements.txt              â† Python dependencies
â”‚   â””â”€â”€ run_api.py                    â† API runner script
â”‚
â””â”€â”€ ğŸ“š Documentation
    â”œâ”€â”€ ARCHITECTURE.md                â† Architecture docs
    â”œâ”€â”€ ARCHITECTURE_DIAGRAM.md        â† This file
    â”œâ”€â”€ PRD.md                         â† Product requirements
    â””â”€â”€ PROJECT_OVERVIEW.md            â† Project overview
```

---

## ğŸ› ï¸ Technology Stack - Ø§Ù„ØªÙ‚Ù†ÙŠØ§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©

### Frontend
- **Next.js 14+** - React framework
- **TypeScript** - Type safety
- **TailwindCSS** - Styling
- **Lucide React** - Icons
- **Amiri Font** - Arabic typography

### Backend
- **FastAPI** - Python web framework
- **Uvicorn** - ASGI server
- **Pydantic** - Data validation
- **LangChain** - LLM integration

### Search & Retrieval
- **BM25Okapi** - Keyword-based search
- **ChromaDB** - Vector database
- **FAISS** - Similarity search
- **multilingual-e5-base** - Embedding model

### LLM
- **Llama 3.3 70B Versatile** - Language model
- **Groq API** - LLM provider
- **langchain-groq** - Groq integration

### Data Processing
- **python-docx** - DOCX file reading
- **json** - Data serialization
- **re** - Text processing

---

## ğŸ” Security & Configuration - Ø§Ù„Ø£Ù…Ø§Ù† ÙˆØ§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª

### Environment Variables
```bash
# env_template.txt
GROQ_API_KEY=gsk_...  # Groq API key for LLM
```

### CORS Configuration
```python
# api/main.py
allow_origins=["*"]  # In production, use specific domain
```

### API Rate Limits
- **Groq Free Tier:**
  - 30 requests/minute
  - 14,400 requests/day

---

## ğŸ“Š Performance Metrics - Ù…Ù‚Ø§ÙŠÙŠØ³ Ø§Ù„Ø£Ø¯Ø§Ø¡

| Metric | Target | Current |
|--------|--------|---------|
| **Search Latency** | < 3s | âœ… ~2s |
| **LLM Response** | < 5s | âœ… ~3s |
| **Page Load** | < 2s | âœ… ~1s |
| **Database Size** | < 10 MB | âœ… ~5 MB |
| **Total Verses** | 687 | âœ… 687 |

---

## ğŸ¯ Key Features - Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©

1. âœ… **Hybrid Search** - BM25 (70%) + FAISS (30%)
2. âœ… **Exact Match** - Fast path for exact verse matches
3. âœ… **LLM Enhancement** - Automatic explanation improvement
4. âœ… **Guardrails** - Reject non-poetry queries
5. âœ… **Heritage UI** - Beautiful Arabic design
6. âœ… **RTL Support** - Full right-to-left support
7. âœ… **Responsive Design** - Mobile & Desktop

---

## ğŸš€ Deployment - Ø§Ù„Ù†Ø´Ø±

### Local Development
```bash
# Start API
python run_api.py  # Port 8000

# Start Frontend
cd tarjuman-ui
npm run dev  # Port 3000
```

### Production (Future)
- **Frontend:** Vercel / Netlify
- **Backend:** AWS / GCP / Railway
- **Database:** Cloud storage (S3 / GCS)

---

**Last Updated:** 2026-01-23  
**Version:** 2.0  
**Status:** âœ… Production Ready
